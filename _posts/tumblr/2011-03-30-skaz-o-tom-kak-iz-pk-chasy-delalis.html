---
layout: post
title: Сказ о том, как из ПК часы делались
tags:
- работа
---
<div class="separator" style="clear: both; text-align: center;"><a href="http://a4.sphotos.ak.fbcdn.net/hphotos-ak-snc6/199549_151989491531487_100001613121427_343368_6356547_n.jpg" imageanchor="1" style="clear:left; float:left;margin-right:1em; margin-bottom:1em"><img border="0" width="320" src="http://a4.sphotos.ak.fbcdn.net/hphotos-ak-snc6/199549_151989491531487_100001613121427_343368_6356547_n.jpg"/></a></div>

<p>Как-то в этом месяце, на работе, было принято решение повесить в цехе красивые часы, которые будут показывать единое время для работников цеха, и оповещать их сигналом о началах и окончаниях перерыва. Занимались этим я и <a href="http://magdelta.blogspot.com/">MAG_delta</a>.Деньги были выделены, комплектующие были куплены, и тут началось самое интересное&#8230;<br/></p>

<h2>Сборка ПК</h2>

<p>При сборке были использованы следующие комплектующие:<br/></p>

<ul><li><a href="http://www.fcenter.ru/products.shtml?eshop/act=h:a:0:0:a:a:a:0:a:1:30:r:3:1:&amp;oper=89274::::">Мат. плата ASUS &#8220;AT3IONT-I Deluxe&#8221;</a></li>
<li>Дешевый 23&#8221; монитор от Samsung, собранный в России</li>
<li>Простенький корпус mini-ITX</li>
<li>VESA крепление для монитора</li>
<li>харды, CD-ROM&#8217;ы, периферия, прочее&#8230;</li>
</ul><p><br/></p>

<h3>Монитор</h3>

<div class="separator" style="clear: both; text-align: center;"><a href="http://a4.sphotos.ak.fbcdn.net/hphotos-ak-snc6/189849_151855968211506_100001613121427_342725_1974917_n.jpg" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" width="320" src="http://a4.sphotos.ak.fbcdn.net/hphotos-ak-snc6/189849_151855968211506_100001613121427_342725_1974917_n.jpg"/></a></div>

<p>Небольшие проблемы начались с самого начала. Приступив к осмотру пришедшего монитора, был обнаружен небольшой дефект: отверстия для крепления в корпусе были неправильно пробиты (как казалось). Сначала MAG_delta попробовал пробить новые отверстия, и это даже получилось. Отверстия пробиты, все довольны, вроде, можно приступить к следующему шагу. Но не тут-то было :) Оказалось, что если потрясти монитор, там весело что-то гремит. Посмотрев еще раз на заднюю крышку монитора, мы обнаружили, что с внутренней стороны отвалилось одно крепления для VESA держалки. Было решено разобрать монитор и посмотреть, что там за фигня происходит. Монитор не стал быстро сопротивляться и мы увидели красиво запечатанный в металл экран монитора. Очень понравилось. В общем, проблема была решена, железка для крепления приделано обратно, все довольны, монитор собран почти без повреждений (не считая утопленной вглубь лампочки питания). В общем, слава Российской сборке! На этом проблемы с монитором закончились. Начался следующий этап&#8230;<br/></p>

<h3>VESA крепление</h3>

<p><strong>Предыстория:</strong> так как в нашем любимом Ф-центре мы VESA креплений не нашли, то было решено купить его перед поездкой на работу. Приехав на савок, не долго ища, мы нашли магазин &#8220;Другой Мир&#8221; (или как-то так), в котором был богатый выбор креплений. Не долго думая, было решено купить самое-самое большое крепление, чтобы хоть одно из отверстий подошло. А продавец всё хотел втюхать какое то маленькое. Убедив продавца, что нам отлично подойдёт именно самое большое, купили его и поехали на работу )<br/>
Приехав на работу, и помучившись с монитором, мы взялись за крепление. И тут всё началось с fail&#8217;а - крепление, внезапно, оказалось слишком большим, и закрывало отверстие для VGA кабеля и кабеля питания. В общем, пришлось идти в цех и просить отрезать лишнюю часть крепления. Заодно, показали куда это всё надо вешать. В итоге, крепление было красиво отрезано и хорошо прикручено. На чем эпопея с ним закончилась. Параллельно с этим мы занимались установкой и настройкой системного блока&#8230;<br/></p>

<h3>Системный блок</h3>

<p>Тут началось самое интересное. Был распакован маленький mini-ITX корпус, безжалостно вынут оттуда встроенный блок питания. Была распакована маленькая mini-ITX материнская плата, которая выглядела очень заманчиво, на первый взгляд. Было всё это собрано, подключен НЖМД на 500Гб от сигейта, CD-ROM для установки, 2Гб памяти (меньше не было :) ), включен внешний блок питания для материнской платы, и всё было к решительному моменту включения. Кнопка включения была нажата и&#8230; 0 реакции. Еще раз - тот же результат. Пришлось задуматься, что бы это могло быть. Через некоторое время раздумий мы решили, что не хватает питания. Было решено отключить жёсткий диск, оставить только CD-ROM. Со второго раза всё включилось и&#8230; вся серверная провоняла первым за этот день убитым CD-ROM&#8217;ом. Немного почесав в затылке, было решено проверить всё это на еще одном CD-ROM&#8217;е. Скажу сразу, это была плохая идея, так как серверная снова провоняла горелой проводкой. Прошло еще немного времени, мы уже вовсю прорабатывали метод установки ОС с флешки на флешку, возможность использования старого-древнего компа уже, на крайний случай, но MAG_delta было мало - он решил убить еще и жесткий диск :) Хитро подключив питание во время работы злополучного компа, это ему удалось. Так кровожадная материнка приняла очередную, и последнюю, жертву. Мы перешли к следующему шагу&#8230;<br/></p>

<h3>Установка ОС</h3>

<p>Установить на эти кровожадные часы-убийцу было решено самый знакомый и близкий мне дистрибутив - <a href="http://agilialinux.ru/">AgiliaLinux</a>. Также он поддерживает легкую установку на флешку, что было очень важно для нас. Так как флешка была всего одна (и та - моя), наш хитрый план был примерно таким: записать установщик на флешку, загрузиться с неё, установить Агилию на эту же флешку, дальше - по обстоятельствам. Внезапно, оказалось, что всё это вполне реально и возможно, и даже работает. Загрузившись с флешки, мы смогли лицезреть приглашение логина. Теперь немного о программной части&#8230;<br/></p>

<h3>Программное обеспечение</h3>

<p>Для самого показа часов было испробовано множество вариантов, даже conky, но мы остановились на xdaliclock, который был в репозитории (правда, только для 64-х битного варианта, но собрать пакет - дело не долгое). Были подобраны опции запуска, настроен автостарт. При помощи пользователя &#8220;<i>medved</i>&#8221; jabber конференции agilialinux был быстро настроен автовход в иксы под нужным пользователем, в общем, всё это само запускалось и работало. Дальше, мы собрали вместе системный блок, монитор, кучу проводов и ИБП и понесли всё это в цех.<br/></p>

<h3>Сборка всего вместе и установка</h3>

<p>Придя на место, мы еще раз подивились красиво установленному и отрезанному креплению, водрузили туда монитор, поставили в соседнее помещение системник с ИБП, соединили всё это и включили&#8230; загрузка пошла, как это не удивительно :) AgiliaLinux загрузился, но максимальное разрешение экрана было - 1024х768. Как оказалось, проблема была в предварительно заказанном VGA кабеле, который брался &#8220;с запасом&#8221;. В общем, его длина была 30 метров, это говорит само за себя). Плюнув на это дело, поставили разрешение (пришлось бегать за клавой-мышью) 800х600, чтобы наверняка, поправили параметры запуска часов и взялись за протягивание сетевого кабеля. Но через 10 минут было обнаружено, что благодаря настройкам энергосбережения монитор выключается сам через эти самые 10 минут. В спешке настроив сеть, я записал магические строчки<br/><code><br/>
xset s off &amp;<br/>
xset -dpms &amp;<br/>
xset s noblank &amp;<br/></code><br/>
в autostart.sh, и эту проблему тоже удалось решить. На этом можно считать первую часть настройки компочасов оконченной. Ждите новостей на следующей неделе.<br/></p>

<h3>Итоги</h3>

<p>В итоге, потратив не более 8 часов, нам удалось собрать, настроить и установить отличные часы, которые синхронизируются с ntp сервером каждый час, показывают большое, видно на всей территории цеха, время, поддерживают удаленное управление и предоставляют кучу других возможностей. Причем всё это собрано в компактном, бесшумном корпусе (из движущихся частей - только маленький кулер на корпусе, который почти не шумит).<br/><i>Из еще не решенных задач:</i> создание аудио оповещений, доработка часов под себя.<br/></p>

<h3>&#8220;Слайды&#8221; :)</h3>

<div class="separator" style="clear: both; text-align: center;"><a href="http://a7.sphotos.ak.fbcdn.net/hphotos-ak-ash4/205474_151856008211502_100001613121427_342728_7527737_n.jpg" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" width="540" src="http://a7.sphotos.ak.fbcdn.net/hphotos-ak-ash4/205474_151856008211502_100001613121427_342728_7527737_n.jpg"/></a></div>

<p><br/></p>

<div class="separator" style="clear: both; text-align: center;"><a href="http://a1.sphotos.ak.fbcdn.net/hphotos-ak-snc6/188736_151988601531576_100001613121427_343364_5895414_n.jpg" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" width="540" src="http://a1.sphotos.ak.fbcdn.net/hphotos-ak-snc6/188736_151988601531576_100001613121427_343364_5895414_n.jpg"/></a></div>

<p><br/></p>

<div class="separator" style="clear: both; text-align: center;"><a href="http://a3.sphotos.ak.fbcdn.net/hphotos-ak-snc6/207696_151988768198226_100001613121427_343367_1179370_n.jpg" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" width="540" src="http://a3.sphotos.ak.fbcdn.net/hphotos-ak-snc6/207696_151988768198226_100001613121427_343367_1179370_n.jpg"/></a></div>

<p><br/></p>

<div class="separator" style="clear: both; text-align: center;"><a href="http://a2.sphotos.ak.fbcdn.net/hphotos-ak-snc6/209014_151855984878171_100001613121427_342726_2647847_n.jpg" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" width="540" src="http://a2.sphotos.ak.fbcdn.net/hphotos-ak-snc6/209014_151855984878171_100001613121427_342726_2647847_n.jpg"/></a></div>

<p><br/></p>

<div class="separator" style="clear: both; text-align: center;"><a href="http://a4.sphotos.ak.fbcdn.net/hphotos-ak-snc6/189849_151855968211506_100001613121427_342725_1974917_n.jpg" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" width="540" src="http://a4.sphotos.ak.fbcdn.net/hphotos-ak-snc6/189849_151855968211506_100001613121427_342725_1974917_n.jpg"/></a></div>

<p><br/></p>

<div class="separator" style="clear: both; text-align: center;"><a href="http://a1.sphotos.ak.fbcdn.net/hphotos-ak-snc6/188728_151856038211499_100001613121427_342729_3542327_n.jpg" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" width="540" src="http://a1.sphotos.ak.fbcdn.net/hphotos-ak-snc6/188728_151856038211499_100001613121427_342729_3542327_n.jpg"/></a></div>

<p><br/>
С этими, некоторыми другими фото Вы можете ознакомиться по <a href="https://www.facebook.com/album.php?aid=34825&amp;id=100001613121427&amp;l=402ac56857">этой</a> ссылке :)</p>
